<div class="container">
  <div class="row">
    <% Exercise.order(:level).each do |exercise| %>
      <% if exercise.level == 0  && current_user.level == 0 %>
        <div class="exercise-div col-xs-6 col-sm-4 col-md-3" data-exercise="tutorial" data-user="<%= current_user.nickname %>">
          <%= link_to exercise.name, "#", class:"exercise tutorial", "data-toggle" => "modal", 'data-target' => '#tutorialModal' %>
        </div>
      <% elsif exercise.level == 0 %>
        <div class="exercise-div col-xs-6 col-sm-4 col-md-3">
          <%= link_to "purgatory docs", "#" "purgatory docs", class:"exercise done" %>
        </div>
      <% elsif current_user.level > exercise.level && current_user.completed_exercise?(exercise.id) %>
        <div class="exercise-div col-xs-6 col-sm-4 col-md-3">
          <%= link_to "ExErCiSE SHOW", "#", class:"exercise done" %>
        </div>
      <% elsif current_user.exercises.pluck(:level).include?(exercise.level) %>
        <div class="exercise-div col-xs-6 col-sm-4 col-md-3">
          <%= link_to exercise.name, "#", class:"exercise current" %>
        </div>
      <% elsif  current_user.level == exercise.level %>
        <div class="exercise-div col-xs-6 col-sm-4 col-md-3">
          <%= link_to exercise.name, "#", class:"exercise new", "data-toggle" => "modal", "data-target" => "#nextExerciseModal", "data-exercise" => exercise.name, "data-user" => current_user.nickname %>
        </div>
      <% else %>
        <div class="exercise-div col-xs-6 col-sm-4 col-md-3">
          <%= link_to exercise.name, "#", class:"exercise locked" %>
        </div>
      <% end %>
    <% end %>
  </div>
</div>

<div class="modal fade" id="tutorialModal" tabindex="-1" role="dialog" aria-labelledby="tutorialModalLabel" >
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="tutorialModal">Welcome to purgatory.</h4>
      </div>
      <div class="modal-body">
        Hey
      </div>
      <div class="modal-footer">
        <%= button_to "start your journey to activerecord paradise", user_purgatory_path, class:"btn btn-start" %>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="nextExerciseModal" tabindex="-1" role="dialog" aria-labelledby="nextExerciseModalLabel" >
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title" id="nextExerciseModal">A new challenge awaits.</h4>
      </div>
      <div class="modal-body">
        A new challenge has been posted to your Purgatory repository. Navigate to your Purgatory directory in the command line and run <pre>git pull origin master</pre>.<br>
        Once you get all tests passing, submit your challenge by running <pre>git push origin master</pre>.<br>
      </div>
      <div class="modal-footer">
        <%= link_to "got it", user_path, class:"btn btn-start" %>
      </div>
    </div>
  </div>
</div>
